#!/bin/bash
LOCATION=$(dirname "$0")
source $LOCATION/../common_tools
ios_choose_device
ios_check_developer_image $SELECTED_DEVICE

take_screenshot(){
  idevicescreenshot -u $SELECTED_DEVICE $FILENAME.png &> /dev/null
  EXIT_CODE=$?
  if [ $EXIT_CODE -eq 0 ]; then
    echo "üì∏ Screenshot saved into $FILENAME.png"
  else
    echo "ü§∑ Screenshot failed, error code: $EXIT_CODE"
    should_proceed "‚ùì Try opening Xcode to fix it?"
    open -a Xcode
    take_screenshot
  fi
}

cd ~/Desktop
if [ -z "$1" ] ; then
  FILENAME=$SELECTED_DEVICE_MODEL-iOS$SELECTED_DEVICE_VERSION-$(date +%Y-%m-%d-%H-%M-%S)
else
  FILENAME=$1
fi

take_screenshot

#TODO add -a
